-- object, model, x,y,z, rx,ry,rz, i, d
local CasinoGame = {
	["The Four Dragons"] = {
		["SLOT"] = {
			["1"] = {
				[2] = {false, 2327, 1965.11, 998.32, 992.99, 0,0,80, 10, 0},
			},
			["2"] = {
				[2] = {false, 2347, 1962.42, 991.89, 992.99, 0,0,54, 10, 0},
			},
			["3"] = {
				[2] = {false, 2327, 1957.75, 987.20, 992.99, 0,0,32, 10, 0},
			},
			["4"] = {
				[2] = {false, 2347, 1964.56, 998.43, 992.99, 0,0,259, 10, 0}, 
			},
			["5"] = {
				[2] = {false, 2327, 1961.95, 992.18, 992.99, 0,0,235, 10, 0},
			},
			["6"] = {
				[2] = {false, 2347, 1957.43, 987.65, 992.99, 0,0,213, 10, 0}, 
			}, 
			["7"] = {
				[2] = {false, 2327, 1965.10, 1037.37, 992.99, 0,0,101, 10, 0},
			},
			["8"] = {
				[2] = {false, 2327, 1962.40, 1043.65, 992.99, 0,0,123, 10, 0},
			},
			["9"] = {
				[2] = {false, 2347, 1957.64, 1048.44, 992.99, 0,0,145, 10, 0},
			},
			["10"] = {
				[2] = {false, 2327, 1964.55, 1037.26, 992.99, 0,0,281, 10, 0},
			},
			["11"] = {
				[2] = {false, 2347, 1961.96, 1043.36, 992.99, 0,0,303, 10, 0},
			},
			["12"] = {
				[2] = {false, 2327, 1957.34, 1047.97, 992.99, 0,0,325, 10, 0},
			},
		},
		["Roulette"] = {
			["1"] = {
				[1] = {false, 1959.2, 1011.47, 992.45, 0,0,270, 10, 0}, 
			}, 
			["2"] = {
				[1] = {false, 1963.52, 1011.47, 992.45, 0,0,270, 10, 0}, 
			}, 
			["3"] = {
				[1] = {false, 1963.52, 1027.05, 992.45, 0,0,270, 10, 0}, 
			}, 
			["4"] = {
				[1] = {false, 1959.20, 1027.05, 992.45, 0,0,270, 10, 0}, 
			}, 
		}
	}, 
	["Caligula's Palace"] = {
		["SLOT"] = {
			["1"] =  {
				[2] = {false, 2347, 2255.17, 1617.55, 1006.78, 0,0,0, 1, 0},
			},
			["2"] =  {
				[2] = {false, 2327, 2255.17, 1618.05, 1006.78, 0,0,180, 1, 0},
			},
			["3"] =  {
				[2] = {false, 2347, 2255.17, 1614.18, 1006.78, 0,0,180, 1, 0},
			},
			["4"] =  {
				[2] = {false, 2327, 2255.17, 1613.65, 1006.78, 0,0,0, 1, 0},
			},
			["5"] =  {
				[2] = {false, 2347, 2255.17, 1610.12, 1006.78, 0,0,180, 1, 0},
			},
			["6"] =  {
				[2] = {false, 2327, 2255.17, 1609.60, 1006.78, 0,0,0, 1, 0},
			},
			["7"] =  {
				[2] = {false, 2347, 2218.65, 1619.08, 1006.78, 0,0,180, 1, 0},
			},
			["8"] =  {
				[2] = {false, 2327, 2218.65, 1618.55, 1006.78, 0,0,0, 1, 0},
			},
			["9"] =  {
				[2] = {false, 2347, 2218.65, 1614.75, 1006.78, 0,0,180, 1, 0},
			},
			["10"] =  {
				[2] = {false, 2327, 2218.65, 1614.22, 1006.78, 0,0,0, 1, 0},
			},
			["11"] =  {
				[2] = {false, 2347, 2218.65, 1592.92, 1006.78, 0,0,180, 1, 0},
			},
			["12"] =  {
				[2] = {false, 2327, 2218.65, 1592.39, 1006.78, 0,0,0, 1, 0},
			},
			["13"] =  {
				[2] = {false, 2347, 2218.65, 1588.61, 1006.78, 0,0,180, 1, 0},
			},
			["14"] =  {
				[2] = {false, 2327, 2218.65, 1588.07, 1006.78, 0,0,0, 1, 0},
			},
			["15"] =  {
				[2] = {false, 2347, 2269.25, 1606.665, 1006.78, 0,0,270, 1, 0},
			},
			["16"] =  {
				[2] = {false, 2327, 2269.78, 1606.665, 1006.78, 0,0,90, 1, 0},
			},
			["17"] =  {
				[2] = {false, 2347, 2273.30, 1606.665, 1006.78, 0,0,270, 1, 0},
			},
			["18"] =  {
				[2] = {false, 2327, 2273.83, 1606.665, 1006.78, 0,0,90, 1, 0},
			},
			["19"] =  {
				[2] = {false, 2347, 2220.67, 1603.915, 1006.78, 0,0,270, 1, 0},
			},
			["20"] =  {
				[2] = {false, 2327, 2221.21, 1603.915, 1006.78, 0,0,90, 1, 0},
			},
			["21"] =  {
				[2] = {false, 2347, 2217.02, 1603.915, 1006.78, 0,0,270, 1, 0},
			},
			["22"] =  {
				[2] = {false, 2327, 2217.55, 1603.915, 1006.78, 0,0,90, 1, 0},
			},
		},
		["Roulette"] = {
			["1"] = {
				[1] = {false, 2229.20, 1619.46, 1006.17, 0,0,0, 1, 0}, 
			}, 
			["2"] = {
				[1] = {false, 2231.92, 1614.77, 1006.17, 0,0,180, 1, 0}, 
			},
			["3"] = {
				[1] = {false, 2240.08, 1619.43, 1006.17, 0,0,0, 1, 0}, 
			}, 
			["4"] = {
				[1] = {false, 2242.79, 1614.73, 1006.17, 0,0,180, 1, 0}, 
			}, 
			["5"] = {
				[1] = {false, 2231.91, 1594.94, 1006.17, 0,0,180, 1, 0}, 
			}, 
			["6"] = {
				[1] = {false, 2231.91, 1589.36, 1006.17, 0,0,180, 1, 0}, 
			}, 
			["7"] = {
				[1] = {false, 2243.71, 1594.94, 1006.17, 0,0,180, 1, 0}, 
			}, 
			["8"] = {
				[1] = {false, 2243.71, 1589.37, 1006.17, 0,0,180, 1, 0}, 
			}, 
		}
	}
}




local RouletteColor = {
	["0"] = "green", 
	["1"] = "red", 
	["2"] = "black", 
	["3"] = "red", 
	["4"] = "black", 
	["5"] = "red", 
	["6"] = "black", 
	["7"] = "red", 
	["8"] = "black", 
	["9"] = "red", 
	["10"] = "black", 
	["11"] = "black", 
	["12"] = "red", 
	["13"] = "black", 
	["14"] = "red", 
	["15"] = "black", 
	["16"] = "red", 
	["17"] = "black", 
	["18"] = "red", 
	["19"] = "red", 
	["20"] = "black", 
	["21"] = "red", 
	["22"] = "black", 
	["23"] = "red", 
	["24"] = "black", 
	["25"] = "red", 
	["26"] = "black", 
	["27"] = "red", 
	["28"] = "black", 
	["29"] = "black", 
	["30"] = "red", 
	["31"] = "black", 
	["32"] = "red", 
	["33"] = "black", 
	["34"] = "red", 
	["35"] = "black", 
	["36"] = "red", 
}



local RouletteMatrix = {
	[1] = {false, false, "0", "0", "0", "0", "0"}, 
	[2] = {"1to18", "1st12", "0+1", false, "0+2", false, "0+3"}, 
	[3] = {"1to18", "1st12", "1", "1+2", "2", "2+3", "3"}, 
	[4] = {"1to18", "1st12", "1+4", false, "2+5", false, "3+6"}, 
	[5] = {"1to18", "1st12", "4", "4+5", "5", "5+6", "6"}, 
	[6] = {"even", "1st12", "4+7", false, "5+8", false, "6+9"}, 
	[7] = {"even", "1st12", "7", "7+8", "8", "8+9", "9"}, 
	[8] = {"even", "1st12", "7+10", false, "8+11", false, "9+12"}, 
	[9] = {"even", "1st12", "10", "10+11", "11", "11+12", "12"}, 
	[10] = {"red", "2nd12", "10+13", false, "11+14", false, "12+15"}, 
	[11] = {"red", "2nd12", "13", "13+14", "14", "14+15", "15"}, 
	[12] = {"red", "2nd12", "13+16", false, "14+17", false, "15+18"}, 
	[13] = {"red", "2nd12", "16", "16+17", "17", "17+18", "18"}, 
	[14] = {"black", "2nd12", "16+19", false, "17+20", false, "18+21"}, 
	[15] = {"black", "2nd12", "19", "19+20", "20", "20+21", "21"}, 
	[16] = {"black", "2nd12", "19+22", false, "20+23", false, "21+24"}, 
	[17] = {"black", "2nd12", "22", "22+23", "23", "23+24", "24"}, 
	[18] = {"odd", "3rd12", "22+25", false, "23+26", false, "24+27"}, 
	[19] = {"odd", "3rd12", "25", "25+26", "26", "26+27", "27"}, 
	[20] = {"odd", "3rd12", "25+28", false, "26+29", false, "27+30"}, 
	[21] = {"odd", "3rd12", "28", "28+29", "29", "29+30", "30"}, 
	[22] = {"19to36", "3rd12", "28+31", false, "29+32", false, "30+33"}, 
	[23] = {"19to36", "3rd12", "31", "31+32", "32", "32+33", "33"}, 
	[24] = {"19to36", "3rd12", "31+34", false, "32+35", false, "33+36"}, 
	[25] = {"19to36", "3rd12", "34", "34+35", "35", "35+36", "36"}, 
	[26] = {false, false, "3to11", false, "3to12", false, "3to13"}, 
}


--offsetx, offsety, up, down, left, right
local CasinoMatrixMap = {
	["0"] = {0.77, 0.25},
	
	["0+1"] = {0.84, 0},
	["0+2"] = {0.84, 0.25},
	["0+3"] = {0.84, 0.50},

	["1"] = {0.92, 0},
	["1+2"] = {0.92, 0.13},
	["2"] = {0.92, 0.25},
	["2+3"] = {0.92, 0.375},
	["3"] = {0.92, 0.50},

	["1+4"] = {1, 0},
	["2+5"] = {1, 0.25},
	["3+6"] = {1, 0.50},
	
	["4"] = {1.07, 0},
	["4+5"] = {1.07, 0.13},
	["5"] = {1.07, 0.25},
	["5+6"] = {1.07, 0.375},
	["6"] = {1.07, 0.50},
	
	["4+7"] = {1.15, 0},
	["5+8"] = {1.15, 0.25},
	["6+9"] = {1.15, 0.50},
	
	["7"] = {1.23, 0}, 
	["7+8"] = {1.23, 0.13}, 
	["8"] = {1.23, 0.25}, 
	["8+9"] = {1.23, 0.375}, 
	["9"] = {1.23, 0.50}, 
	
	["7+10"] = {1.31, 0}, 
	["8+11"] = {1.31, 0.25}, 
	["9+12"] = {1.31, 0.50}, 
	
	["10"] = {1.38, 0}, 
	["10+11"] = {1.38, 0.13}, 
	["11"] = {1.38, 0.25}, 
	["11+12"] = {1.38, 0.375}, 
	["12"] = {1.38, 0.50}, 
	
	["10+13"] = {1.46, 0}, 
	["11+14"] = {1.46, 0.25}, 
	["12+15"] = {1.46, 0.50}, 
	
	["13"] = {1.53, 0}, 
	["13+14"] = {1.53, 0.13}, 
	["14"] = {1.53, 0.25}, 
	["14+15"] = {1.53, 0.375}, 
	["15"] = {1.53, 0.50}, 
	
	["13+16"] = {1.61, 0}, 
	["14+17"] = {1.61, 0.25}, 
	["15+18"] = {1.61, 0.50}, 
	
	["16"] = {1.68, 0}, 
	["16+17"] = {1.68, 0.13}, 
	["17"] = {1.68, 0.25}, 
	["17+18"] = {1.68, 0.375}, 
	["18"] = {1.68, 0.50}, 
	
	["16+19"] = {1.76, 0}, 
	["17+20"] = {1.76, 0.25}, 
	["18+21"] = {1.76, 0.50}, 
	
	["19"] = {1.84, 0}, 
	["19+20"] = {1.84, 0.13}, 
	["20"] = {1.84, 0.25}, 
	["20+21"] = {1.84, 0.375}, 
	["21"] = {1.84, 0.50}, 
	
	["19+22"] = {1.91, 0}, 
	["20+23"] = {1.91, 0.25}, 
	["21+24"] = {1.91, 0.50}, 
	
	["22"] = {1.99, 0}, 
	["22+23"] = {1.99, 0.13}, 
	["23"] = {1.99, 0.25}, 
	["23+24"] = {1.99, 0.375}, 
	["24"] = {1.99, 0.50}, 
	
	["22+25"] = {2.07, 0}, 
	["23+26"] = {2.07, 0.25}, 
	["24+27"] = {2.07, 0.50}, 
	
	["25"] = {2.15, 0}, 
	["25+26"] = {2.15, 0.13}, 
	["26"] = {2.15, 0.25}, 
	["26+27"] = {2.15, 0.375}, 
	["27"] = {2.15, 0.50}, 
		
	["25+28"] = {2.22, 0}, 
	["26+29"] = {2.22, 0.25}, 
	["27+30"] = {2.22, 0.50}, 
	
	["28"] = {2.3, 0}, 
	["28+29"] = {2.3, 0.13}, 
	["29"] = {2.3, 0.25}, 
	["29+30"] = {2.3, 0.375}, 
	["30"] = {2.3, 0.50}, 
	
	["28+31"] = {2.38, 0}, 
	["29+32"] = {2.38, 0.25}, 
	["30+33"] = {2.38, 0.50}, 
	             
	["31"] = {2.45, 0}, 
	["31+32"] = {2.45, 0.13}, 
	["32"] = {2.45, 0.25}, 
	["32+33"] = {2.45, 0.375}, 
	["33"] = {2.45, 0.50}, 
	
	["31+34"] = {2.53, 0}, 
	["32+35"] = {2.53, 0.25}, 
	["33+36"] = {2.53, 0.50}, 
	
	["34"] = {2.61, 0}, 
	["34+35"] = {2.61, 0.13}, 
	["35"] = {2.61, 0.25}, 
	["35+36"] = {2.61, 0.375}, 
	["36"] = {2.61, 0.50}, 
	
	["3to11"] = {2.76, 0}, 
	["3to12"] = {2.76, 0.25}, 
	["3to13"] = {2.76, 0.50}, 
	
	["1st12"] = {1.16, -0.225}, 
	["2nd12"] = {1.77, -0.225}, 
	["3rd12"] = {2.38, -0.225}, 
	
	["1to18"] = {1, -0.47}, 
	["even"] = {1.3, -0.47}, 
	["red"] = {1.6, -0.47}, 
	["black"] = {1.92, -0.47}, 
	["odd"] = {2.22, -0.47}, 
	["19to36"] = {2.55, -0.47}, 
}





function getMatrix(x,y,z,rx,ry,rz)
    rx, ry, rz = math.rad(rx), math.rad(ry), math.rad(rz)
    local matrix = {}
    matrix[1] = {}
    matrix[1][1] = math.cos(rz)*math.cos(ry) - math.sin(rz)*math.sin(rx)*math.sin(ry)
    matrix[1][2] = math.cos(ry)*math.sin(rz) + math.cos(rz)*math.sin(rx)*math.sin(ry)
    matrix[1][3] = -math.cos(rx)*math.sin(ry)
    matrix[1][4] = 1
    
    matrix[2] = {}
    matrix[2][1] = -math.cos(rx)*math.sin(rz)
    matrix[2][2] = math.cos(rz)*math.cos(rx)
    matrix[2][3] = math.sin(rx)
    matrix[2][4] = 1
	
    matrix[3] = {}
    matrix[3][1] = math.cos(rz)*math.sin(ry) + math.cos(ry)*math.sin(rz)*math.sin(rx)
    matrix[3][2] = math.sin(rz)*math.sin(ry) - math.cos(rz)*math.cos(ry)*math.sin(rx)
    matrix[3][3] = math.cos(rx)*math.cos(ry)
    matrix[3][4] = 1
	
    matrix[4] = {}
    matrix[4][1], matrix[4][2], matrix[4][3] = x,y,z
    matrix[4][4] = 1
	
    return matrix
end


function getPositionFromOffset(x,y,z,rx,ry,rz, offX,offY,offZ)
    local m = getMatrix(x,y,z,rx,ry,rz)
	x = offX * m[1][1] + offY * m[2][1] + offZ * m[3][1] + m[4][1]
	y = offX * m[1][2] + offY * m[2][2] + offZ * m[3][2] + m[4][2]
	z = offX * m[1][3] + offY * m[2][3] + offZ * m[3][3] + m[4][3]
    return x, y, z
end


function AddPlayerMoney(thePlayer, count, victory)
	if(count < 0) then 
		if getElementData(thePlayer, "Geld")+count < 0 then
			local c = count+getElementData(thePlayer, "Geld")
			outputChatBox("Dir fehlen "..c-c-c.."€", thePlayer)
			cancelEvent()
			return false
		end
	end
	
	setElementData(thePlayer, "Geld", getElementData(thePlayer, "Geld")+count)
	if(victory) then
		outputChatBox("Du hast "..count.."€ gewonnen!", thePlayer)
	end
	return true
end
addEvent("AddPlayerMoney", true)
addEventHandler("AddPlayerMoney", root, AddPlayerMoney)


function Check(funcname, ...)
    local arg = {...}
    
    if (type(funcname) ~= "string") then
        error("Argument type mismatch at 'Check' ('funcname'). Expected 'string', got '"..type(funcname).."'.", 2)
    end
    if (#arg % 3 > 0) then
        error("Argument number mismatch at 'Check'. Expected #arg % 3 to be 0, but it is "..(#arg % 3)..".", 2)
    end
    
    for i=1, #arg-2, 3 do
        if (type(arg[i]) ~= "string" and type(arg[i]) ~= "table") then
            error("Argument type mismatch at 'Check' (arg #"..i.."). Expected 'string' or 'table', got '"..type(arg[i]).."'.", 2)
        elseif (type(arg[i+2]) ~= "string") then
            error("Argument type mismatch at 'Check' (arg #"..(i+2).."). Expected 'string', got '"..type(arg[i+2]).."'.", 2)
        end
        
        if (type(arg[i]) == "table") then
            local aType = type(arg[i+1])
            for _, pType in next, arg[i] do
                if (aType == pType) then
                    aType = nil
                    break
                end
            end
            if (aType) then
                error("Argument type mismatch at '"..funcname.."' ('"..arg[i+2].."'). Expected '"..table.concat(arg[i], "' or '").."', got '"..aType.."'.", 3)
            end
        elseif (type(arg[i+1]) ~= arg[i]) then
            error("Argument type mismatch at '"..funcname.."' ('"..arg[i+2].."'). Expected '"..arg[i].."', got '"..type(arg[i+1]).."'.", 3)
        end
    end
end

function string.explode(self, separator)
    Check("string.explode", "string", self, "ensemble", "string", separator, "separator")

    if (#self == 0) then return {} end
    if (#separator == 0) then return { self } end

    return loadstring("return {\""..self:gsub(separator, "\",\"").."\"}")()
end



local CasinoObjectInfo = {
	[2327] = {
		[0] = "Cherry",
		[18] = "Bar",
		[36] = "Cherry",
		[54] = "Blueberry",
		[72] = "Seven",
		[90] = "Melon",
		[108] = "Seven",
		[126] = "Blueberry",
		[144] = "Bell",
		[162] = "Melon",
		[180] = "Cherry",
		[198] = "Double Bar",
		[216] = "Cherry",
		[234] = "Tripple Bar",
		[252] = "Seven",
		[270] = "Blueberry",
		[288] = "Bar",
		[306] = "Seven",
		[324] = "Melon",
		[342] = "Bell"
	},
	[2347] = {
		[0] = "Double Gold",
		[20] = "69",
		[40] = "Gold",
		[60] = "Bell",
		[80] = "Cherry",
		[100] = "Blueberry",
		[120] = "Cherry",
		[140] = "Blueberry",
		[160] = "Bell",
		[180] = "69",
		[200] = "Bell",
		[220] = "Gold",
		[240] = "Cherry",
		[260] = "Blueberry",
		[280] = "69",
		[300] = "Blueberry",
		[320] = "Bell",
		[340] = "Cherry",
	}, 
	[1979] = {
		[0] = 1, 
		[1] = 1, 
		[2] = 1, 
		[3] = 1, 
		[4] = 1, 
		[5] = 1, 
		[6] = 20, 
		[7] = 20, 
		[8] = 20, 
		[9] = 20, 
		[10] = 20, 
		[11] = 20, 
		[12] = 20, 
		[13] = 20, 
		[14] = 20, 
		[15] = 20, 
		[16] = 14, 
		[17] = 14, 
		[18] = 14, 
		[19] = 14, 
		[20] = 14, 
		[21] = 14, 
		[22] = 14, 
		[23] = 14, 
		[24] = 14, 
		[25] = 14, 
		[26] = 31, 
		[27] = 31, 
		[28] = 31, 
		[29] = 31, 
		[30] = 31, 
		[31] = 31, 
		[32] = 31, 
		[33] = 31, 
		[34] = 31, 
		[35] = 9, 
		[36] = 9, 
		[37] = 9, 
		[38] = 9, 
		[39] = 9, 
		[40] = 9, 
		[41] = 9, 
		[42] = 9, 
		[43] = 9, 
		[44] = 9, 
		[45] = 22, 
		[46] = 22, 
		[47] = 22, 
		[48] = 22, 
		[49] = 22, 
		[50] = 22, 
		[51] = 22, 
		[52] = 22, 
		[53] = 22, 
		[54] = 22, 
		[55] = 18, 
		[56] = 18, 
		[57] = 18, 
		[58] = 18, 
		[59] = 18, 
		[60] = 18, 
		[61] = 18, 
		[62] = 18, 
		[63] = 18, 
		[64] = 18, 
		[65] = 29, 
		[66] = 29, 
		[67] = 29, 
		[68] = 29, 
		[69] = 29, 
		[70] = 29, 
		[71] = 29, 
		[72] = 29, 
		[73] = 29, 
		[74] = 7, 
		[75] = 7, 
		[76] = 7, 
		[77] = 7, 
		[78] = 7, 
		[79] = 7, 
		[80] = 7, 
		[81] = 7, 
		[82] = 7, 
		[83] = 7, 
		[84] = 7, 
		[85] = 28, 
		[86] = 28, 
		[87] = 28, 
		[88] = 28, 
		[89] = 28, 
		[90] = 28, 
		[91] = 28, 
		[92] = 28, 
		[93] = 12, 
		[94] = 12, 
		[95] = 12, 
		[96] = 12, 
		[97] = 12, 
		[98] = 12, 
		[99] = 12, 
		[100] = 12, 
		[101] = 12, 
		[102] = 12, 
		[103] = 35, 
		[104] = 35, 
		[105] = 35, 
		[106] = 35, 
		[107] = 35, 
		[108] = 35, 
		[109] = 35, 
		[110] = 35, 
		[111] = 35, 
		[112] = 35, 
		[113] = 3, 
		[114] = 3, 
		[115] = 3, 
		[116] = 3, 
		[117] = 3, 
		[118] = 3, 
		[119] = 3, 
		[120] = 3, 
		[121] = 3, 
		[122] = 26, 
		[123] = 26, 
		[124] = 26, 
		[125] = 26, 
		[126] = 26, 
		[127] = 26, 
		[128] = 26, 
		[129] = 26, 
		[130] = 26, 
		[131] = 0, 
		[132] = 0, 
		[133] = 0, 
		[134] = 0, 
		[135] = 0, 
		[136] = 0, 
		[137] = 0, 
		[138] = 0, 
		[139] = 0, 
		[140] = 0, 
		[141] = 32, 
		[142] = 32, 
		[143] = 32, 
		[144] = 32, 
		[145] = 32, 
		[146] = 32, 
		[147] = 32, 
		[148] = 32, 
		[149] = 32, 
		[150] = 32, 
		[151] = 15, 
		[152] = 15, 
		[153] = 15, 
		[154] = 15, 
		[155] = 15, 
		[156] = 15, 
		[157] = 15, 
		[158] = 15, 
		[159] = 15, 
		[160] = 15, 
		[161] = 15, 
		[162] = 19, 
		[163] = 19, 
		[164] = 19, 
		[165] = 19, 
		[166] = 19, 
		[167] = 19, 
		[168] = 19, 
		[169] = 19, 
		[170] = 19, 
		[171] = 4, 
		[172] = 4, 
		[173] = 4, 
		[174] = 4, 
		[175] = 4, 
		[176] = 4, 
		[177] = 4, 
		[178] = 4, 
		[179] = 4, 
		[180] = 4, 
		[181] = 21, 
		[182] = 21, 
		[183] = 21, 
		[184] = 21, 
		[185] = 21, 
		[186] = 21, 
		[187] = 21, 
		[188] = 21, 
		[189] = 21, 
		[190] = 21, 
		[191] = 2, 
		[192] = 2, 
		[193] = 2, 
		[194] = 2, 
		[195] = 2, 
		[196] = 2, 
		[197] = 2, 
		[198] = 2, 
		[199] = 2, 
		[200] = 2, 
		[201] = 25, 
		[202] = 25, 
		[203] = 25, 
		[204] = 25, 
		[205] = 25, 
		[206] = 25, 
		[207] = 25, 
		[208] = 25, 
		[209] = 25, 
		[210] = 25, 
		[211] = 17, 
		[212] = 17, 
		[213] = 17, 
		[214] = 17, 
		[215] = 17, 
		[216] = 17, 
		[217] = 17, 
		[218] = 17, 
		[219] = 34, 
		[220] = 34, 
		[221] = 34, 
		[222] = 34, 
		[223] = 34, 
		[224] = 34, 
		[225] = 34, 
		[226] = 34, 
		[227] = 34, 
		[228] = 34, 
		[229] = 6, 
		[230] = 6, 
		[231] = 6, 
		[232] = 6, 
		[233] = 6, 
		[234] = 6, 
		[235] = 6, 
		[236] = 6, 
		[237] = 6, 
		[238] = 6, 
		[239] = 27, 
		[240] = 27, 
		[241] = 27, 
		[242] = 27, 
		[243] = 27, 
		[244] = 27, 
		[245] = 27, 
		[246] = 27, 
		[247] = 27, 
		[248] = 27, 
		[249] = 27, 
		[250] = 13, 
		[251] = 13, 
		[252] = 13, 
		[253] = 13, 
		[254] = 13, 
		[255] = 13, 
		[256] = 13, 
		[257] = 13, 
		[258] = 13, 
		[259] = 13, 
		[260] = 36, 
		[261] = 36, 
		[262] = 36, 
		[263] = 36, 
		[264] = 36, 
		[265] = 36, 
		[266] = 36, 
		[267] = 36, 
		[268] = 36, 
		[269] = 36, 
		[270] = 11, 
		[271] = 11, 
		[272] = 11, 
		[273] = 11, 
		[274] = 11, 
		[275] = 11, 
		[276] = 11, 
		[277] = 11, 
		[278] = 11, 
		[279] = 30, 
		[280] = 30, 
		[281] = 30, 
		[282] = 30, 
		[283] = 30, 
		[284] = 30, 
		[285] = 30, 
		[286] = 30, 
		[287] = 30, 
		[288] = 30, 
		[289] = 8, 
		[290] = 8, 
		[291] = 8, 
		[292] = 8, 
		[293] = 8, 
		[294] = 8, 
		[295] = 8, 
		[296] = 8, 
		[297] = 8, 
		[298] = 8, 
		[299] = 23, 
		[300] = 23, 
		[301] = 23, 
		[302] = 23, 
		[303] = 23, 
		[304] = 23, 
		[305] = 23, 
		[306] = 23, 
		[307] = 23, 
		[308] = 23, 
		[309] = 10, 
		[310] = 10, 
		[311] = 10, 
		[312] = 10, 
		[313] = 10, 
		[314] = 10, 
		[315] = 10, 
		[316] = 10, 
		[317] = 10, 
		[318] = 5, 
		[319] = 5, 
		[320] = 5, 
		[321] = 5, 
		[322] = 5, 
		[323] = 5, 
		[324] = 5, 
		[325] = 5, 
		[326] = 5, 
		[327] = 5, 
		[328] = 24, 
		[329] = 24, 
		[330] = 24, 
		[331] = 24, 
		[332] = 24, 
		[333] = 24, 
		[334] = 24, 
		[335] = 24, 
		[336] = 24, 
		[337] = 24, 
		[338] = 16, 
		[339] = 16, 
		[340] = 16, 
		[341] = 16, 
		[342] = 16, 
		[343] = 16, 
		[344] = 16, 
		[345] = 16, 
		[346] = 16, 
		[347] = 16, 
		[348] = 33, 
		[349] = 33, 
		[350] = 33, 
		[351] = 33, 
		[352] = 33, 
		[353] = 33, 
		[354] = 33, 
		[355] = 33, 
		[356] = 33, 
		[357] = 33, 
		[358] = 1, 
		[359] = 1, 
		[360] = 1, 
	}, 
}
		
local CasinoPrice = {
	["Blueberry"] = 2,
	["Cherry"] = 4,
	["Bar"] = 7,
	["Gold"] = 7,
	["Bell"] = 10,
	["Double Bar"] = 15,
	["Double Gold"] = 15,
	["69"] = 20,
	["Tripple Bar"] = 25,
	["Melon"] = 30,
	["Seven"] = 30
}



function RotateBandits(obj, times)
	local MaxCombo = 360/getArrSize(CasinoObjectInfo[getElementModel(obj)])
	local rx,ry,rz = getElementRotation(obj)
	rx = math.round(rx)
	local out = rx+(times*MaxCombo)
	if(out >= 360) then
		out = out-(360*math.floor(out/360))
	end

	setTimer(function(obj)
		local x,y,z = getElementPosition(obj)
		local rx,ry,rz = getElementRotation(obj)
		rx = math.round(rx)
		setElementRotation(obj,rx+MaxCombo,ry,rz, "default")
	end, 50, times, obj)
	return CasinoObjectInfo[getElementModel(obj)][out]
end


function getColorRoulette(num) 
	num = RouletteColor[tostring(num)] 
	if(num == "red") then
		num = {255,0,0,255}
	elseif(num == "black") then
		num = {0,0,0,255}
	elseif(num == "green") then
		num = {0,255,0,255}
	end
	return num
end



local PlayerRoulette = {} -- [thePlayer] = {{casino}, position}
function RotateRoulette(dat, times)
	local casino, casinogame, game = dat[1], dat[2], dat[3]
	local PlayerList = {}
	for number, data in pairs(CasinoGame[casino][casinogame][game]["push"]) do
		for _, arr in pairs(data) do
			PlayerList[arr[2]] = true
		end
	end
	
	local obj = CasinoGame[casino][casinogame][game][1][1]
	local MaxCombo = 360/getArrSize(CasinoObjectInfo[getElementModel(obj)])
	local rx,ry,rz = getElementRotation(obj)
	rz = math.round(rz)
	local out = math.round((rz+(times*MaxCombo)+360)%360, 0)
	setTimer(function(obj, MaxCombo)
		local x,y,z = getElementPosition(obj)
		local rx,ry,rz = getElementRotation(obj)
		rz = math.round((rz+(MaxCombo*10)+360)%360, 0)
		setElementRotation(obj,rx,ry,rz, "default")
		local color = getColorRoulette(CasinoObjectInfo[getElementModel(obj)][rz])
		for thePlayer,_ in pairs(PlayerList) do
			triggerClientEvent(getPlayerFromName(thePlayer), "RouletteTick", getPlayerFromName(thePlayer), CasinoObjectInfo[getElementModel(obj)][rz], color)
		end
	end, 50, math.floor(times/10), obj, MaxCombo)
	return CasinoObjectInfo[getElementModel(obj)][out]
end



function PlayCasino(thePlayer, dat)
	dat = fromJSON(dat)
	local casino, casinogame, game = dat[1], dat[2], dat[3]
	if(casinogame == "SLOT") then
		if(not isTimer(CasinoGame[casino][casinogame][game]["timer"])) then
			if(triggerEvent("AddPlayerMoney", thePlayer, thePlayer, -dat[4])) then
				local MaxCombo = 360/getArrSize(CasinoObjectInfo[CasinoGame[casino][casinogame][game][2][2]])
				local r1,r2,r3 = math.random(1,MaxCombo), math.random(MaxCombo,MaxCombo*2), math.random(MaxCombo*2,MaxCombo*3)
				victory = false
				local ro1, ro2, ro3 = RotateBandits(CasinoGame[casino][casinogame][game][1][1], r1), RotateBandits(CasinoGame[casino][casinogame][game][2][1], r2), RotateBandits(CasinoGame[casino][casinogame][game][3][1], r3)
				if(ro1 == ro2) then
					victory = CasinoPrice[ro1]*CasinoPrice[ro2]
					if(ro2 == ro3) then
						victory = CasinoPrice[ro1]*CasinoPrice[ro2]*CasinoPrice[ro3]
					end
				end
				CasinoGame[casino][casinogame][game]["timer"] = setTimer(function(thePlayer, victory)
					if(victory) then
						triggerEvent("AddPlayerMoney", thePlayer, thePlayer, victory, "Gewonnen!")
					end
				end, 1000+(50*r3), 1, thePlayer, victory)
			end
		end
	elseif(casinogame == "Roulette") then
		if(not isTimer(CasinoGame[casino][casinogame][game]["timer"])) then
			if(not PlayerRoulette[thePlayer]) then
				if(not CasinoGame[casino][casinogame][game]["push"]) then CasinoGame[casino][casinogame][game]["push"] = {} end
				toggleAllControls(thePlayer, false)   
				PlayerRoulette[thePlayer] = {dat, {15, 5}}
				local x,y,z = getPositionFromOffset(CasinoGame[casino][casinogame][game][1][2], 
				CasinoGame[casino][casinogame][game][1][3], 
				CasinoGame[casino][casinogame][game][1][4], 
				CasinoGame[casino][casinogame][game][1][5], 
				CasinoGame[casino][casinogame][game][1][6], 
				CasinoGame[casino][casinogame][game][1][7], 
				4, -1, 2.5)
				triggerClientEvent(thePlayer, "RoulettePlay", thePlayer, {x,y,z, CasinoGame[casino][casinogame][game][1][2], CasinoGame[casino][casinogame][game][1][3], CasinoGame[casino][casinogame][game][1][4]-2}, dat[4])
				x,y,z = GetRoulettePos({casino, casinogame, game}, RouletteMatrix[15][5])
				triggerClientEvent(thePlayer, "SetRoulettePos", thePlayer, x,y,z, CasinoGame[casino][casinogame][game][1][8])
			end
		end
	
	end
end
addEvent("PlayCasino", true)
addEventHandler("PlayCasino", root, PlayCasino)



function EndRoulette(thePlayer)
	toggleAllControls(thePlayer, true)   
	PlayerRoulette[thePlayer] = false
end
addEvent("EndRoulette", true)
addEventHandler("EndRoulette", root, EndRoulette)


function GetNextMatrixPos(dat, x,y)
	if(RouletteMatrix[dat[1]+x]) then
		if(y > 0) then
			for sloty = dat[2]+y, 7 do
				if(RouletteMatrix[dat[1]+x][sloty]) then
					if(RouletteMatrix[dat[1]+x][sloty] ~= RouletteMatrix[dat[1]][dat[2]]) then
						return {dat[1]+x, sloty}
					end
				end
			end
		elseif(y < 0) then
			for sloty = -dat[2]-y, 0 do
				if(RouletteMatrix[dat[1]+x][-sloty]) then
					if(RouletteMatrix[dat[1]+x][-sloty] ~= RouletteMatrix[dat[1]][dat[2]]) then
						return {dat[1]+x, -sloty}
					end
				end
			end
		else
			if(x > 0) then
				for slotx = dat[1]+x, 26 do
					if(RouletteMatrix[slotx][dat[2]+y]) then
						if(RouletteMatrix[slotx][dat[2]+y] ~= RouletteMatrix[dat[1]][dat[2]]) then
							return {slotx, dat[2]+y}
						end
					end
				end
			elseif(x < 0) then
				for slotx = -dat[1]-x, 0 do
					if(RouletteMatrix[-slotx][dat[2]+y]) then
						if(RouletteMatrix[-slotx][dat[2]+y] ~= RouletteMatrix[dat[1]][dat[2]]) then
							return {-slotx, dat[2]+y}
						end
					end
				end
			end
		end
	end
	return {dat[1], dat[2]}
end


local ChkCost = {
	[1916] = 100, 
	[1905] = 1000, 
	[1906] = 10000, 
	[1909] = 100000, 
}




function GetPlayerTotalWager(thePlayer)
	local total = 0
	for casino, data in pairs(CasinoGame[PlayerRoulette[thePlayer][1][1]][PlayerRoulette[thePlayer][1][2]][PlayerRoulette[thePlayer][1][3]]["push"]) do
		for _, arr in pairs(data) do
			if(arr[2] == getPlayerName(thePlayer)) then
				total = total+ChkCost[getElementModel(arr[1])]
			end
		end
	end
	return total
end


function GetPlayerPayout(thePlayer)
	return 0
end


function RouletteControl(thePlayer, control)
	local dat = PlayerRoulette[thePlayer][1]
	local casino, casinogame, game = dat[1], dat[2], dat[3]
	
	if(control == "up") then control = GetNextMatrixPos(PlayerRoulette[thePlayer][2], -1,0)
	elseif(control == "down") then control = GetNextMatrixPos(PlayerRoulette[thePlayer][2], 1,0)
	elseif(control == "left") then control = GetNextMatrixPos(PlayerRoulette[thePlayer][2], 0,-1)
	elseif(control == "right") then control = GetNextMatrixPos(PlayerRoulette[thePlayer][2], 0,1)
	elseif(control == "push") then 
		if(GetPlayerTotalWager(thePlayer) < dat[4]) then
			local pushnumber = RouletteMatrix[PlayerRoulette[thePlayer][2][1]][PlayerRoulette[thePlayer][2][2]]
			if(not CasinoGame[casino][casinogame][game]["push"][pushnumber]) then CasinoGame[casino][casinogame][game]["push"][pushnumber] = {} end
			
			local model = false
			for _model, cost in pairs(ChkCost) do
				if(cost == dat[4]/100) then
					model = _model
				end
			end
			
			if(triggerEvent("AddPlayerMoney", thePlayer, thePlayer, -(dat[4]/100))) then
				local x,y,z = GetRoulettePos({casino, casinogame, game}, pushnumber)
				CasinoGame[casino][casinogame][game]["push"][pushnumber][#CasinoGame[casino][casinogame][game]["push"][pushnumber]+1] = {createObject(model, x,y,z+(0.003*#CasinoGame[casino][casinogame][game]["push"][pushnumber]), 0, 0, 0), getPlayerName(thePlayer)}
				setElementInterior(CasinoGame[casino][casinogame][game]["push"][pushnumber][#CasinoGame[casino][casinogame][game]["push"][pushnumber]][1], CasinoGame[casino][casinogame][game][1][8])
				triggerClientEvent(thePlayer, "SetRouletteWager", thePlayer, GetPlayerTotalWager(thePlayer), GetPlayerPayout(thePlayer))
				return true
			else
				return false
			end
		else
			return false
		end
	elseif(control == "rotate") then 
		local times = math.random(200,500)
		local ro = RotateRoulette({casino, casinogame, game}, times)
		local color = RouletteColor[tostring(ro)]
		CasinoGame[casino][casinogame][game]["timer"] = setTimer(function(thePlayer)
			local PlayerList = {}
			for number, data in pairs(CasinoGame[casino][casinogame][game]["push"]) do
				for _, arr in pairs(data) do
					PlayerList[arr[2]] = 0
				end
			end
			local color = getColorRoulette(ro)
			for thePlayer,_ in pairs(PlayerList) do
				triggerClientEvent(getPlayerFromName(thePlayer), "RouletteTick", getPlayerFromName(thePlayer), ro, color)
			end

			
			for number, dat in pairs(CasinoGame[casino][casinogame][game]["push"]) do
				for i, obj in pairs(dat) do
					if(tostring(ro) == number) then
						PlayerList[obj[2]] = PlayerList[obj[2]]+20
					elseif(number == "black" or number == "red") then
						if(RouletteColor[tostring(ro)] == number) then
							PlayerList[obj[2]] = PlayerList[obj[2]]+1.5
						end
					elseif(number == "1to18") then
						if(ro >= 1 and ro <= 18) then
							PlayerList[obj[2]] = PlayerList[obj[2]]+2.5
						end
					elseif(number == "19to36") then
						if(ro >= 19 and ro <= 36) then
							PlayerList[obj[2]] = PlayerList[obj[2]]+2.5
						end
					elseif(number == "odd") then
						if math.fmod(ro,2) ~= 0 then
							PlayerList[obj[2]] = PlayerList[obj[2]]+1.5
						end
					elseif(number == "even") then
						if math.fmod(ro,2) == 0 then
							PlayerList[obj[2]] = PlayerList[obj[2]]+1.5
						end
					elseif(number == "1st12") then
						if(ro >= 1 and ro <= 12) then
							PlayerList[obj[2]] = PlayerList[obj[2]]+2.5
						end
					elseif(number == "2nd12") then
						if(ro >= 13 and ro <= 24) then
							PlayerList[obj[2]] = PlayerList[obj[2]]+2.5
						end
					elseif(number == "3rd12") then
						if(ro >= 25 and ro <= 36) then
							PlayerList[obj[2]] = PlayerList[obj[2]]+2.5
						end
					elseif(number == "3to11") then
						if(ro == 1 or ro == 4 or ro == 7 or ro == 10 or ro == 13 or ro == 16 or ro == 19 or ro == 22 or ro == 25 or ro == 28 or ro == 31 or ro == 34) then
							PlayerList[obj[2]] = PlayerList[obj[2]]+2.5
						end
					elseif(number == "3to12") then
						if(ro == 2 or ro == 5 or ro == 8 or ro == 11 or ro == 14 or ro == 17 or ro == 20 or ro == 23 or ro == 26 or ro == 29 or ro == 32 or ro == 35) then
							PlayerList[obj[2]] = PlayerList[obj[2]]+2.5
						end
					elseif(number == "3to13") then
						if(ro == 3 or ro == 6 or ro == 9 or ro == 12 or ro == 15 or ro == 18 or ro == 21 or ro == 24 or ro == 27 or ro == 30 or ro == 33 or ro == 36) then
							PlayerList[obj[2]] = PlayerList[obj[2]]+2.5
						end
					elseif(#string.explode(number, "+") > 1) then
						for _, num in pairs(string.explode(number, "+")) do
							if(tostring(ro) == num) then
								PlayerList[obj[2]] = PlayerList[obj[2]]+10
							end
						end
					end
					destroyElement(obj[1])
					CasinoGame[casino][casinogame][game]["push"][number][i] = nil
				end
			end
			
			
			
			for thePlayer, val in pairs(PlayerList) do
				triggerClientEvent(getPlayerFromName(thePlayer), "SetRouletteWager", getPlayerFromName(thePlayer), 0, val*(dat[4]/100))
				if(val > 0) then
					triggerEvent("AddPlayerMoney", getPlayerFromName(thePlayer), getPlayerFromName(thePlayer), val*(dat[4]/100), "Gewonnen!")
				end
			end
			
			
		end, 1000+(50*(times/10)), 1, thePlayer, ro)
		return true
	else return false end
	local nextpos = RouletteMatrix[control[1]][control[2]]
	if nextpos then
		local x,y,z = GetRoulettePos({casino, casinogame, game}, nextpos)
		
		PlayerRoulette[thePlayer][2] = control
		triggerClientEvent(thePlayer, "SetRoulettePos", thePlayer, x,y,z)
	else
		return false
	end
end
addEvent("RouletteControl", true)
addEventHandler("RouletteControl", root, RouletteControl)




function table.copy(t)
	local t2 = {};
	for k,v in pairs(t) do
		if type(v) == "table" then
			t2[k] = table.copy(v);
		else
			t2[k] = v;
		end
	end
	return t2;
end




function math.round(number, decimals, method)
    decimals = decimals or 0
    local factor = 10 ^ decimals
    if (method == "ceil" or method == "floor") then return math[method](number * factor) / factor
    else return tonumber(("%."..decimals.."f"):format(number)) end
end

function getArrSize(arr)
	local i = 0
	for _,_ in pairs(arr) do i=i+1 end
	return i
end


 
function getPointInFrontOfPoint(x, y, z, rZ, dist)
	local offsetRot = math.rad(rZ)
	local vx = x + dist * math.cos(offsetRot)
	local vy = y + dist * math.sin(offsetRot)  
	return vx, vy, z
end





function GetRoulettePos(dat, pos)
	local casino, casinogame, game = dat[1], dat[2], dat[3]
	return getPositionFromOffset(CasinoGame[casino][casinogame][game][1][2], 
				CasinoGame[casino][casinogame][game][1][3], 
				CasinoGame[casino][casinogame][game][1][4], 
				CasinoGame[casino][casinogame][game][1][5], 
				CasinoGame[casino][casinogame][game][1][6], 
				CasinoGame[casino][casinogame][game][1][7], 
	CasinoMatrixMap[pos][1], CasinoMatrixMap[pos][2],-0.12)
end




local RandomRoulette = {10000, 25000, 50000, 75000}
local RandomSlot = {100, 250, 500, 1000}


for CasinoName, data in pairs(CasinoGame) do
	for Game, datas in pairs(data) do
		if(Game == "SLOT") then
			for name, obj in pairs(datas) do
				local col = createColSphere(obj[2][3], obj[2][4], obj[2][5], 1.2)
				setElementData(col, "Casino", toJSON({CasinoName, Game, name, RandomSlot[math.random(#RandomSlot)]}))
				
				CasinoGame[CasinoName][Game][name][2][1] = createObject(obj[2][2], obj[2][3], obj[2][4], obj[2][5], obj[2][6], obj[2][7], obj[2][8])
				setElementInterior(CasinoGame[CasinoName][Game][name][2][1], obj[2][9])
				setElementDimension(CasinoGame[CasinoName][Game][name][2][1], obj[2][10])
				
				CasinoGame[CasinoName][Game][name][1] = table.copy(obj[2])
				obj[1][3], obj[1][4], obj[1][5] = getPointInFrontOfPoint(obj[2][3], obj[2][4], obj[2][5], obj[2][8]-180, 0.12)
				CasinoGame[CasinoName][Game][name][1][1] = createObject(obj[1][2], obj[1][3], obj[1][4], obj[1][5], obj[1][6], obj[1][7], obj[1][8])
				setElementInterior(CasinoGame[CasinoName][Game][name][1][1], obj[1][9])
				setElementDimension(CasinoGame[CasinoName][Game][name][1][1], obj[1][10])
				
				CasinoGame[CasinoName][Game][name][3] = table.copy(obj[2])
				obj[3][3], obj[3][4], obj[3][5] = getPointInFrontOfPoint(obj[2][3], obj[2][4], obj[2][5], obj[2][8], 0.12)
				CasinoGame[CasinoName][Game][name][3][1] = createObject(obj[3][2], obj[3][3], obj[3][4], obj[3][5], obj[3][6], obj[3][7], obj[3][8])
				setElementInterior(CasinoGame[CasinoName][Game][name][3][1], obj[3][9])
				setElementDimension(CasinoGame[CasinoName][Game][name][3][1], obj[3][10])
			end
		elseif(Game == "Roulette") then
			for name, obj in pairs(datas) do
				CasinoGame[CasinoName][Game][name][1][1] = createObject(1979, obj[1][2], obj[1][3], obj[1][4], 0, 0, obj[1][7])
				setElementInterior(CasinoGame[CasinoName][Game][name][1][1], obj[1][8])
				
				local x,y,z = getPointInFrontOfPoint(obj[1][2], obj[1][3], obj[1][4], obj[1][7], 1.2)
				local col = createColSphere(x,y,z, 2.8)
				setElementData(col, "Casino", toJSON({CasinoName, Game, name, RandomRoulette[math.random(#RandomRoulette)]}))
			end
		end
	end
end




